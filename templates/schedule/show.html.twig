{% extends 'base.html.twig' %}

{% block title %}
   Plan zajęć
{% endblock %}

{% block stylesheets %}
   <link rel="stylesheet" href="{{ asset('css/schedule.css') }}"/>
{% endblock %}

{% block body %}
   <div id="schedule">
      <h1 id="main-title">Harmonogram klasy [
         {{ class.name }}
         ]
      </h1>
      <table class="table table-striped text-center">
         <thead>
            <tr>
               <th>Data</th>
               {% for lessonTime in lessonTimes %}
                  <th>{{ lessonTime.time }}</th>
               {% endfor %}
               <td></td>
            </tr>
         </thead>

         <tbody>
            {% for schedule in schedules %}
               <tr>
                  <td class="item align-middle">
                     <div>{{ schedule.date|date("Y-m-d") }}</div>
                  </td>
                  {% for lessonTime in lessonTimes %}
                     {% set empty = true %}
                     {% for lesson in schedule.lessons %}
                        {% set continue = true %}

                        {% if lesson.lessonTime != lessonTime %}
                           {% set continue = false %}
                        {% endif %}

                        {% if continue %}
                           {% set empty = false %}
                           <td class="item">
                              <div class="{{ lesson.lessonStatus.name }}">
                                 <div>
                                    <span class="fw-bold">{{ lesson.subject.name }}</span>
                                    ({{ lesson.place }})
                                 </div>
                                 <div>({{ lesson.teacher.name }})</div>
                              </div>
                           </td>
                        {% endif %}
                     {% endfor %}

                     {% if empty %}
                        <td class="item position-relative">
                           <div class="center empty-column">-</div>
                        </td>
                     {% endif %}
                  {% endfor %}

                  <td class="item position-relative icon-column">
                     <div class="center">
                        {% if schedule.canManage == true %}
                           <a href="{{ path('app_schedule_manage', {class_id: class.id, date: schedule.date|date("Y-m-d") }) }}">
                              <img class="img-medium" src="{{ asset('images/settings.png') }}"/>
                           </a>
                        </div>
                     {% endif %}
                  </td>
               </tr>
            {% endfor %}
         </tbody>
      </table>
   </div>

   <div id="buttons" class="container-fluid">
      <div class="text-center row">
         <a class="col-3 offset-1" href="{{ path('app_schedule_show', {class_id: class.id, date: prevDate}) }}">
            <button class="btn btn-primary w-100">Poprzednia strona</button>
         </a>

         <a class="col-4" href="{{ path('app_scheduleTemplate_show', {class_id: class.id, day: "monday"}) }}">
            <button class="btn btn-primary w-100">Powrót do harmonogramu</button>
         </a>

         <a class="col-3" href="{{ path('app_schedule_show', {class_id: class.id, date: nextDate}) }}">
            <button class="btn btn-primary w-100">Następna strona</button>
         </a>
      </div>
   </div>

   <div id="legend" class="mt-2 p-2">
      <h3 class="fs-6 text-center">LEGENDA</h3>

      <div class="container-fluid row">
         {% for status in lessonStatuses %}
            <div class="col-6 d-flex">
               <div class="square mt-1 {{ status.name }}"></div>
               <div class="ps-2">{{ status.description }}</div>
            </div>
         {% endfor %}
      </div>
   </div>
{% endblock %}
